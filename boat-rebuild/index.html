<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Boat Rebuild | Denys Shlyakhtovskyy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/style.css">

  <style>
    .top-link{
      display: block;
      width: fit-content;
      margin: 14px 0 8px 0;
    }

    .content-center{
      text-align: center;
      margin-top: 8px;
    }

    .content-center .section-link{
      display: block;
      width: 100%;
      margin: 14px 0 8px 0;
    }

    .content-center .drop-panel{
      text-align: center;
      margin: 0 auto 8px auto;
      max-width: 70ch;
    }

    .drop-panel .drop-panel .drop-inner{
      text-align: left;
    }

    .photo-grid-wrap{
      max-width: 1000px;
      margin: 0 auto;
    }

    .photo-grid{
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
      margin: 10px auto 0;
      width: min(100%, 1000px);
    }

    .photo-grid > .photo-item{
      flex: 0 1 240px;
      max-width: 320px;
    }

    .photo-item{
      margin: 0;
      border-radius: 12px;
      overflow: hidden;
      background: rgba(0,0,0,0.03);
      border: 1px solid rgba(0,0,0,0.10);
      cursor: pointer;
      position: relative;
      transform: translateZ(0);
      transition: transform 180ms ease;
    }

    .photo-item:hover{
      transform: scale(1.03);
    }

    .photo-item img,
    .photo-item video{
      display: block;
      width: 100%;
      height: auto;
      aspect-ratio: 4 / 3;
      object-fit: cover;
    }

    .img-overlay{
      position: fixed;
      inset: 0;
      z-index: 9999;
      display: grid;
      place-items: center;
      padding: 24px;
      background: transparent;
      opacity: 0;
      pointer-events: none;
      transition: opacity 220ms ease;
    }

    .img-overlay.is-open{
      opacity: 1;
      pointer-events: auto;
    }

    .img-overlay .stage{
      width: min(1000px, 92vw);
      max-height: 82vh;
      display: grid;
      grid-template-rows: auto auto;
      gap: 10px;
    }

    .img-overlay .stage-img{
      width: 100%;
      max-height: 72vh;
      border-radius: 14px;
      overflow: hidden;
      background: transparent;
      border: none;
      position: relative;
    }

    .img-overlay .stage-img img,
    .img-overlay .stage-img video{
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      background: transparent;
    }

.img-overlay .stage-img img,
.img-overlay .stage-img video{
  display: block;
}

.img-overlay[data-mode="image"] .stage-img video{
  display: none;
}

.img-overlay[data-mode="video"] .stage-img img{
  display: none;
}


    .img-overlay .stage-caption{
      color: rgba(0,0,0,0.85);
      font-size: 0.95rem;
      text-align: center;
      padding: 10px 12px;
      border-radius: 12px;
      background: rgba(0,0,0,0.06);
      border: 1px solid rgba(0,0,0,0.10);
    }

    .img-clone{
      position: fixed;
      z-index: 10000;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 16px 48px rgba(0,0,0,0.25);
      will-change: width, height, top, left;
      transition: width 420ms cubic-bezier(.2,.8,.2,1),
                  height 420ms cubic-bezier(.2,.8,.2,1),
                  top 420ms cubic-bezier(.2,.8,.2,1),
                  left 420ms cubic-bezier(.2,.8,.2,1);
    }

    .img-clone img,
    .img-clone video{
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .video-ui{
      position: absolute;
      top: 10px;
      left: 10px;
      display: none;
      gap: 8px;
      z-index: 5;
    }

    .video-ui button{
      appearance: none;
      border: 1px solid rgba(0,0,0,0.18);
      background: rgba(255,255,255,0.85);
      border-radius: 10px;
      padding: 8px 10px;
      line-height: 1;
      cursor: pointer;
      font-size: 16px;
      user-select: none;
    }

    .video-ui button:active{
      transform: translateY(1px);
    }

    .video-ui .mute.is-muted{
      position: relative;
    }

    .video-ui .mute.is-muted::after{
      content: "";
      position: absolute;
      left: 6px;
      right: 6px;
      top: 50%;
      height: 2px;
      background: rgba(0,0,0,0.65);
      transform: rotate(-25deg);
      transform-origin: center;
    }
  </style>
</head>

<body>
  <div class="container">
    <a class="back" href="/projects/">‚Üê Back to Projects</a>
    <h1>Boat Rebuild</h1>

    <p>
      I bought a boat with a cracked engine block and rebuilt it by sourcing a truck-variant 4.3L Chevy V6 long block and swapping it in. The job required pulling the engine, transferring marine-specific hardware, and rebuilding the sterndrive before testing and reassembly.
    </p>

    <hr>

    <section class="drop" data-drop>
      <a class="section-link top-link" href="#" data-drop-btn>Overview</a>

      <div class="drop-panel" hidden aria-hidden="true" data-drop-panel>
        <div class="drop-inner">
          <div class="content-center">

            <a class="section-link" href="#" data-sub-btn="symptoms-diagnostics">Diagnostics</a>
            <div class="drop-panel" hidden aria-hidden="true" data-sub-panel="symptoms-diagnostics">
              <div class="drop-inner"></div>
              <p>When I went to pick up the boat, we tried cranking the engine but the starter was just clicking, even though the battery was fully charged. That suggested the engine was likely seized and couldn‚Äôt rotate. After pulling the dipstick, I found milky white oil with a small icicle forming on the end, which confirmed there was water in the crankcase. This pointed to internal engine damage and explained why the engine wouldn‚Äôt turn over.</p>
            </div>

            <a class="section-link" href="#" data-sub-btn="repair">Repair</a>
            <div class="drop-panel" hidden aria-hidden="true" data-sub-panel="repair">
              <div class="drop-inner"></div>
            </div>
            <h3>Engine</h3>
            <p> The repair involved sourcing a replacement block and rotating assembly from a junkyard. We pulled the heads off several 4.3 L Chevy engines we could find and selected a block with cylinder walls in good condition and no noticeable ridge. The block and cylinder heads were then machined, and I reused the original marine heads because they had larger valves than the automotive versions. After reassembly, I transferred all of the marine-specific accessories ‚Äî including the water pump, oil filter housing, alternator, and related hardware ‚Äî onto the rebuilt engine. The finished motor was painted before being installed back into the boat‚Äôs hull.</p>
         <hr>
            <h3>Stern-drive</h3>
            <p>As part of the repair, I removed the stern drive to service the drivetrain components. The lower gear set was replaced with a remanufactured unit, and the raw-water pump in the stern drive was replaced along with all associated gaskets and seals. I also replaced the gimbal bearing (the bearing that supports the stern drive input shaft through the transom assembly) and rebuilt the U-joints in the drive shaft assembly. Before reinstalling the stern drive, I used an engine alignment tool to properly align the engine coupler with the stern drive input shaft to ensure smooth power transfer and prevent premature wear.
</p>
          </div>
        </div>
      </div>
    </section>

    <section class="drop" data-drop>
      <a class="section-link top-link" href="#" data-drop-btn>Media</a>

      <div class="drop-panel" hidden aria-hidden="true" data-drop-panel>
        <div class="drop-inner">
          <div class="content-center">
            <div class="photo-grid-wrap">
<div class="photo-grid" data-photo-grid>
  <figure class="photo-item" data-photo-item data-type="image" data-src="/assets/photos/boat/b1.png" data-caption="1992 Larson Legacy 180">
    <img src="/assets/photos/boat/b1.png" alt="Photo 1">
  </figure>

  <figure class="photo-item" data-photo-item data-type="image" data-src="/assets/photos/boat/b2.png" data-caption="1992 Larson Legacy 180">
    <img src="/assets/photos/boat/b2.png" alt="Photo 2">
  </figure>

  <figure class="photo-item" data-photo-item data-type="image" data-src="/assets/photos/boat/b3.png" data-caption="1992 Larson Legacy 180">
    <img src="/assets/photos/boat/b3.png" alt="Photo 3">
  </figure>

  <figure class="photo-item" data-photo-item data-type="image" data-src="/assets/photos/boat/b4.jpg" data-caption="Engine removal.">
    <img src="/assets/photos/boat/b4.jpg" alt="Photo 4">
  </figure>

  <figure class="photo-item" data-photo-item data-type="image" data-src="/assets/photos/boat/b5.jpg" data-caption="Replacement block.">
    <img src="/assets/photos/boat/b5.jpg" alt="Photo 5">
  </figure>

<figure class="photo-item"
        data-photo-item
        data-type="video"
        data-src="/assets/photos/boat/b6.mov"
        data-thumb="/assets/photos/boat/boat-thumb.png"
        data-caption="Engine running.">
  <img src="/assets/photos/boat/boat-thumb.png" alt="Video">
</figure>
</div>

            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="img-overlay" data-img-overlay aria-hidden="true">
      <div class="stage">
        <div class="stage-img">
          <div class="video-ui" data-video-ui>
            <button type="button" class="replay" data-video-replay>‚ü≤</button>
            <button type="button" class="mute is-muted" data-video-mute>üîä</button>
          </div>
          <img data-overlay-img src="" alt="">
          <video data-overlay-video playsinline autoplay loop muted preload="metadata"></video>

        </div>
        <div class="stage-caption" data-overlay-caption></div>
      </div>
    </div>
<script>
  function shiftToViewportCenter(el){
    const r = el.getBoundingClientRect();
    return (window.innerWidth / 2) - (r.left + r.width / 2);
  }

  function waitForTransition(el, prop){
    return new Promise((resolve) => {
      const onEnd = (e) => {
        if (e.propertyName !== prop) return;
        el.removeEventListener("transitionend", onEnd);
        resolve();
      };
      el.addEventListener("transitionend", onEnd);
    });
  }

  async function openPanel(panel){
    panel.hidden = false;
    panel.setAttribute("aria-hidden", "false");
    panel.style.maxHeight = "0px";
    panel.getBoundingClientRect();
    panel.classList.add("is-open");
    panel.style.maxHeight = panel.scrollHeight + "px";
    await waitForTransition(panel, "max-height");
    panel.style.maxHeight = "none";
  }

  async function closePanel(panel){
    panel.style.maxHeight = panel.scrollHeight + "px";
    panel.getBoundingClientRect();
    panel.classList.remove("is-open");
    panel.style.maxHeight = "0px";
    await waitForTransition(panel, "max-height");
    panel.hidden = true;
    panel.setAttribute("aria-hidden", "true");
  }

  function hardCloseInside(root){
    root.querySelectorAll(".drop-panel").forEach((p) => {
      p.classList.remove("is-open");
      p.style.maxHeight = "0px";
      p.hidden = true;
      p.setAttribute("aria-hidden", "true");
    });
    root.querySelectorAll(".section-link").forEach((a) => a.classList.remove("is-selected"));
  }

  document.querySelectorAll("[data-drop]").forEach((drop) => {
    const btn = drop.querySelector("[data-drop-btn]");
    const panel = drop.querySelector("[data-drop-panel]");
    if (!btn || !panel) return;

    let open = false;
    let sliding = false;

    async function slideToCenter(){
      if (sliding) return;
      sliding = true;
      btn.style.transform = "translateX(0)";
      btn.getBoundingClientRect();
      btn.style.transform = `translateX(${shiftToViewportCenter(btn)}px)`;
      await waitForTransition(btn, "transform");
      sliding = false;
    }

    async function slideBack(){
      if (sliding) return;
      sliding = true;
      btn.style.transform = "translateX(0)";
      await waitForTransition(btn, "transform");
      sliding = false;
    }

    btn.addEventListener("click", async (e) => {
      e.preventDefault();
      open = !open;

      if (open){
        btn.classList.add("is-selected");
        await slideToCenter();
        await openPanel(panel);
      } else {
        hardCloseInside(panel);
        await closePanel(panel);
        btn.classList.remove("is-selected");
        await slideBack();
      }
    });

    drop.querySelectorAll("[data-sub-btn]").forEach((subBtn) => {
      const key = subBtn.getAttribute("data-sub-btn");
      const subPanel = drop.querySelector(`[data-sub-panel="${key}"]`);
      if (!subPanel) return;

      subBtn.addEventListener("click", async (e) => {
        e.preventDefault();
        if (panel.hidden) return;

        if (subPanel.hidden){
          subBtn.classList.add("is-selected");
          await openPanel(subPanel);
        } else {
          await closePanel(subPanel);
          subBtn.classList.remove("is-selected");
        }
      });
    });

    window.addEventListener("resize", () => {
      if (!open) return;
      btn.style.transform = `translateX(${shiftToViewportCenter(btn)}px)`;
      if (!panel.hidden && panel.style.maxHeight !== "none"){
        panel.style.maxHeight = panel.scrollHeight + "px";
      }
    });
  });

  (function initMediaGrid(){
    const grid = document.querySelector("[data-photo-grid]");
    if (!grid) return;

    const overlay = document.querySelector("[data-img-overlay]");
    const overlayImg = document.querySelector("[data-overlay-img]");
    const overlayVideo = document.querySelector("[data-overlay-video]");
    const caption = document.querySelector("[data-overlay-caption]");
    const videoUI = document.querySelector("[data-video-ui]");
    const btnReplay = document.querySelector("[data-video-replay]");
    const btnMute = document.querySelector("[data-video-mute]");

    let activeItem = null;
    let animating = false;

    function box(r){
      return { top: r.top, left: r.left, width: r.width, height: r.height };
    }

    function place(el, b){
      el.style.top = b.top + "px";
      el.style.left = b.left + "px";
      el.style.width = b.width + "px";
      el.style.height = b.height + "px";
    }

    function setOverlayMode(mode){
      overlay.setAttribute("data-mode", mode);
    }

    function resetOverlayMedia(){
      overlayImg.style.visibility = "hidden";
      overlayVideo.style.visibility = "hidden";

      overlayImg.removeAttribute("src");

      overlayVideo.pause();
      overlayVideo.removeAttribute("src");
      overlayVideo.load();
    }

    async function safePlayWithFallback(){
      overlayVideo.currentTime = 0;

      overlayVideo.muted = false;
      btnMute.classList.remove("is-muted");

      try {
        await overlayVideo.play();
        return;
      } catch (e) {}

      overlayVideo.muted = true;
      btnMute.classList.add("is-muted");
      try { await overlayVideo.play(); } catch (e) {}
    }

    async function openItem(item){
      if (animating) return;
      animating = true;
      activeItem = item;

      const type = item.dataset.type || "image";
      const src = item.dataset.src || "";
      const cap = item.dataset.caption || "";

      const thumb = item.querySelector("img");
      if (!thumb){
        animating = false;
        activeItem = null;
        return;
      }

      caption.textContent = cap;
      resetOverlayMedia();

      if (type === "video"){
        setOverlayMode("video");
        videoUI.style.display = "flex";
        overlayVideo.src = src;
        overlayVideo.load();
      } else {
        setOverlayMode("image");
        videoUI.style.display = "none";
        overlayImg.src = src;
      }

      const start = box(thumb.getBoundingClientRect());

      const clone = document.createElement("div");
      clone.className = "img-clone";
      clone.innerHTML = `<img src="${thumb.src}" alt="">`;
      document.body.appendChild(clone);
      place(clone, start);

      overlay.classList.add("is-open");
      overlay.setAttribute("aria-hidden", "false");
      overlay.getBoundingClientRect();

      const target = box(overlay.querySelector(".stage-img").getBoundingClientRect());

      requestAnimationFrame(() => place(clone, target));
      await new Promise((r) => setTimeout(r, 460));

      clone.remove();

      if (type === "video"){
        overlayVideo.style.visibility = "visible";
        overlayVideo.onloadeddata = () => { safePlayWithFallback(); };
      } else {
        overlayImg.style.visibility = "visible";
      }

      animating = false;
    }

    async function closeItem(){
      if (!activeItem || animating) return;
      animating = true;

      const thumb = activeItem.querySelector("img");
      if (!thumb){
        overlay.classList.remove("is-open");
        overlay.setAttribute("aria-hidden", "true");
        resetOverlayMedia();
        videoUI.style.display = "none";
        activeItem = null;
        animating = false;
        return;
      }

      const end = box(thumb.getBoundingClientRect());
      const start = box(overlay.querySelector(".stage-img").getBoundingClientRect());

      const clone = document.createElement("div");
      clone.className = "img-clone";
      clone.innerHTML = `<img src="${thumb.src}" alt="">`;
      document.body.appendChild(clone);
      place(clone, start);

      overlayVideo.pause();

      overlay.classList.remove("is-open");
      overlay.setAttribute("aria-hidden", "true");

      requestAnimationFrame(() => place(clone, end));
      await new Promise((r) => setTimeout(r, 460));

      clone.remove();

      resetOverlayMedia();
      videoUI.style.display = "none";
      activeItem = null;
      animating = false;
    }

    grid.addEventListener("click", (e) => {
      const item = e.target.closest("[data-photo-item]");
      if (!item) return;

      if (item === activeItem) closeItem();
      else if (!activeItem) openItem(item);
      else closeItem().then(() => openItem(item));
    });

    overlay.addEventListener("click", (e) => {
      if (e.target.closest("[data-video-ui]")) return;
      closeItem();
    });

    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape") closeItem();
    });

    btnReplay.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
      overlayVideo.currentTime = 0;
      overlayVideo.play().catch(() => {});
    });

    btnMute.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
      overlayVideo.muted = !overlayVideo.muted;
      btnMute.classList.toggle("is-muted", overlayVideo.muted);
      overlayVideo.play().catch(() => {});
    });
  })();
</script>


  </div>
</body>
</html>
